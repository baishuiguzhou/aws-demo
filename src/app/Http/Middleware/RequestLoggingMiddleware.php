<?php\n\nnamespace App\\Http\\Middleware;\n\nuse Closure;\nuse Illuminate\\Http\\Request;\nuse Illuminate\\Support\\Facades\\Log;\n\nclass RequestLoggingMiddleware\n{\n    public function handle(Request , Closure )\n    {\n         = microtime(true);\n         = ();\n         = (microtime(true) - ) * 1000;\n\n         = [\n            'message' => 'request_access_log',\n            'method' => ->getMethod(),\n            'path' => ->getPathInfo(),\n            'status' => ->getStatusCode(),\n            'ip' => ->ip(),\n            'user_agent' => ->userAgent(),\n            'duration_ms' => round(, 2),\n            'trace_id' => ->header('X-Amzn-Trace-Id', ''),\n            'time' => now()->toIso8601String(),\n        ];\n\n        Log::info(json_encode(, JSON_UNESCAPED_UNICODE));\n\n        return ;\n    }\n}\n
